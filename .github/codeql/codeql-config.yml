name: "CodeQL Security Configuration"

# For Go projects in subdirectories, specify paths to include
paths:
  - 'my-go-backend/**'

paths-ignore:
  - 'node_modules/**'
  - 'dist/**'
  - 'build/**'
  - '.nuxt/**'
  - '.output/**'
  - 'vendor/**'
  - 'server/**/*.go'
  - 'router/**/*.go'

# Define custom sanitizers for SSRF protection
queries:
  - uses: security-extended

# Custom extensions for Go
extensions:
  - name: go-custom-sanitizers
    data:
      # Mark validateURLForNetworkRequest and buildSafeURL as SSRF sanitizers
      sanitizers:
        - kind: ssrf
          function: validateURLForNetworkRequest
        - kind: ssrf
          function: buildSafeURL
