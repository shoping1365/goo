<template>
  <div class="space-y-6">
    <!-- Ù‡Ø¯Ø± Ø¨Ø®Ø´ -->
    <div class="bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-6">
      <h2 class="text-2xl font-bold text-gray-900 mb-2">ğŸ¦ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ</h2>
      <p class="text-gray-600">Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ùˆ ØªØ£ÛŒÛŒØ¯ Ø¢Ù†Ù‡Ø§</p>
    </div>

    <!-- Ø¢Ù…Ø§Ø± Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Ú©Ù„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">Ú©Ù„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§</h3>
          <span class="text-xs bg-blue-100 text-blue-800 rounded-full px-3 py-1">Ø«Ø¨Øª Ø´Ø¯Ù‡</span>
        </div>
        <div class="text-3xl font-bold text-blue-600 mb-2">{{ cardStats.totalCards }}</div>
        <div class="flex items-center text-sm text-gray-600">
          <span class="text-green-500">+{{ cardStats.dailyGrowth }}%</span>
          <span class="mx-2">Ø§Ø² Ø¯ÛŒØ±ÙˆØ²</span>
        </div>
      </div>

      <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡ -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡</h3>
          <span class="text-xs bg-green-100 text-green-800 rounded-full px-3 py-1">ÙØ¹Ø§Ù„</span>
        </div>
        <div class="text-3xl font-bold text-green-600 mb-2">{{ cardStats.verifiedCards }}</div>
        <div class="flex items-center text-sm text-gray-600">
          <span class="text-green-500">{{ cardStats.verificationRate }}%</span>
          <span class="mx-2">Ù†Ø±Ø® ØªØ£ÛŒÛŒØ¯</span>
        </div>
      </div>

      <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯</h3>
          <span class="text-xs bg-yellow-100 text-yellow-800 rounded-full px-3 py-1">Ø§Ù†ØªØ¸Ø§Ø±</span>
        </div>
        <div class="text-3xl font-bold text-yellow-600 mb-2">{{ cardStats.pendingCards }}</div>
        <div class="flex items-center text-sm text-gray-600">
          <span class="text-yellow-500">{{ cardStats.pendingPercentage }}%</span>
          <span class="mx-2">Ø§Ø² Ú©Ù„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§</span>
        </div>
      </div>

      <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø³Ø¯ÙˆØ¯ -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡</h3>
          <span class="text-xs bg-red-100 text-red-800 rounded-full px-3 py-1">Ù…Ø³Ø¯ÙˆØ¯</span>
        </div>
        <div class="text-3xl font-bold text-red-600 mb-2">{{ cardStats.blockedCards }}</div>
        <div class="flex items-center text-sm text-gray-600">
          <span class="text-red-500">{{ cardStats.blockedPercentage }}%</span>
          <span class="mx-2">Ø§Ø² Ú©Ù„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§</span>
        </div>
      </div>
    </div>

    <!-- ÙÛŒÙ„ØªØ±Ù‡Ø§ -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
        <!-- ÙˆØ¶Ø¹ÛŒØª -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆØ¶Ø¹ÛŒØª</label>
          <select v-model="statusFilter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" @change="refresh()">
            <option value="">Ù‡Ù…Ù‡</option>
            <option value="active">ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡</option>
            <option value="pending">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯</option>
            <option value="blocked">Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡</option>
            <option value="rejected">Ø±Ø¯ Ø´Ø¯Ù‡</option>
          </select>
        </div>

        <!-- Ø¨Ø§Ù†Ú© -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø¨Ø§Ù†Ú©</label>
          <select v-model="bankFilter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" @change="refresh()">
            <option value="">Ù‡Ù…Ù‡</option>
            <option value="melli">Ù…Ù„ÛŒ</option>
            <option value="mellat">Ù…Ù„Øª</option>
            <option value="parsian">Ù¾Ø§Ø±Ø³ÛŒØ§Ù†</option>
            <option value="sepah">Ø³Ù¾Ù‡</option>
            <option value="tejarat">ØªØ¬Ø§Ø±Øª</option>
          </select>
        </div>

        <!-- Ù†ÙˆØ¹ Ú©Ø§Ø±Øª -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ú©Ø§Ø±Øª</label>
          <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">Ù‡Ù…Ù‡</option>
            <option value="debit">Ú©Ø§Ø±Øª Ø¹Ø§Ø¨Ø±Ø¨Ø§Ù†Ú©</option>
            <option value="credit">Ú©Ø§Ø±Øª Ø§Ø¹ØªØ¨Ø§Ø±ÛŒ</option>
            <option value="prepaid">Ú©Ø§Ø±Øª Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø®Øª</option>
          </select>
        </div>

        <!-- Ø¬Ø³ØªØ¬Ùˆ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø¬Ø³ØªØ¬Ùˆ</label>
          <input
type="text" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª" 
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
      </div>

      <div class="flex justify-between items-center">
        <button class="px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
          Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±
        </button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 text-sm rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500">
          Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„ØªØ±Ù‡Ø§
        </button>
      </div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold text-gray-900">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ</h3>
        <div class="flex space-x-2 space-x-reverse">
          <button class="px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
            ØªØ£ÛŒÛŒØ¯ Ù‡Ù…Ù‡
          </button>
          <button class="px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
            Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡
          </button>
          <button class="px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
          </button>
        </div>
      </div>
      
      <div class="overflow-x-auto">
        <table class="w-full text-sm text-right">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-gray-700 font-medium">
                <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              </th>
              <th class="px-4 py-3 text-gray-700 font-medium">Ú©Ø§Ø±Ø¨Ø±</th>
              <th class="px-4 py-3 text-gray-700 font-medium">Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª</th>
              <th class="px-4 py-3 text-gray-700 font-medium">Ø¨Ø§Ù†Ú©</th>
              <th class="px-4 py-3 text-gray-700 font-medium">Ù†ÙˆØ¹ Ú©Ø§Ø±Øª</th>
              <th class="px-4 py-3 text-gray-700 font-medium">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª</th>
              <th class="px-4 py-3 text-gray-700 font-medium">ÙˆØ¶Ø¹ÛŒØª</th>
              <th class="px-4 py-3 text-gray-700 font-medium">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr v-for="card in bankCards" :key="card.id" class="hover:bg-gray-50">
              <td class="px-4 py-3">
                <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              </td>
              <td class="px-4 py-3">
                <div class="flex items-center">
                  <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-xs font-medium text-gray-600">
                    {{ card.userInitials }}
                  </div>
                  <div class="mr-3">
                    <div class="text-sm font-medium text-gray-900">{{ card.userName }}</div>
                    <div class="text-xs text-gray-500">{{ card.userEmail }}</div>
                  </div>
                </div>
              </td>
              <td class="px-4 py-3 text-gray-900 font-medium">{{ card.cardNumber }}</td>
              <td class="px-4 py-3">
                <div class="flex items-center">
                  <div class="w-6 h-6 bg-gray-100 rounded flex items-center justify-center mr-2">
                    <span class="text-xs">{{ card.bankIcon }}</span>
                  </div>
                  <span class="text-sm text-gray-700">{{ card.bankName }}</span>
                </div>
              </td>
              <td class="px-4 py-3">
                <span :class="getCardTypeClass(card.cardType)" class="px-2 py-1 text-xs rounded-full">
                  {{ card.cardType }}
                </span>
              </td>
              <td class="px-4 py-3 text-gray-600">{{ card.registrationDate }}</td>
              <td class="px-4 py-3">
                <span :class="getStatusClass(card.status)" class="px-2 py-1 text-xs rounded-full">
                  {{ card.status }}
                </span>
              </td>
              <td class="px-4 py-3">
                <div class="flex space-x-2 space-x-reverse">
                  <button class="text-blue-600 hover:text-blue-800 text-sm">Ø¬Ø²Ø¦ÛŒØ§Øª</button>
                  <button v-if="card.status === 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯'" class="text-green-600 hover:text-green-800 text-sm" @click="verifyCard(card.id)">ØªØ£ÛŒÛŒØ¯</button>
                  <button v-if="card.status === 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯'" class="text-red-600 hover:text-red-800 text-sm" @click="rejectCard(card.id)">Ø±Ø¯</button>
                  <button v-if="card.status === 'ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡'" class="text-red-600 hover:text-red-800 text-sm" @click="blockCard(card.id)">Ù…Ø³Ø¯ÙˆØ¯</button>
                  <button v-if="card.status === 'Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡'" class="text-green-600 hover:text-green-800 text-sm" @click="unblockCard(card.id)">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù†</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ -->
      <div class="flex items-center justify-between mt-6">
        <div class="text-sm text-gray-700">
          Ù†Ù…Ø§ÛŒØ´ {{ paginationInfo.start }} ØªØ§ {{ paginationInfo.end }} Ø§Ø² {{ paginationInfo.total }} Ú©Ø§Ø±Øª
        </div>
        <div class="flex space-x-2 space-x-reverse">
          <button class="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">Ù‚Ø¨Ù„ÛŒ</button>
          <button class="px-3 py-1 text-sm bg-blue-600 text-white rounded-lg">1</button>
          <button class="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">2</button>
          <button class="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">3</button>
          <button class="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">Ø¨Ø¹Ø¯ÛŒ</button>
        </div>
      </div>
    </div>

    <!-- Ø¢Ù…Ø§Ø± Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ù†Ú© -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ù†Ú©</h3>
        <div class="space-y-4">
          <div v-for="bank in bankStats" :key="bank.name" class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="w-4 h-4 rounded-full mr-3" :style="{ backgroundColor: bank.color }"></div>
              <span class="text-sm text-gray-700">{{ bank.name }}</span>
            </div>
            <div class="flex items-center space-x-2 space-x-reverse">
              <span class="text-sm font-medium text-gray-900">{{ bank.count }}</span>
              <span class="text-sm text-gray-500">({{ bank.percentage }}%)</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª</h3>
        <div class="space-y-4">
          <div v-for="status in statusStats" :key="status.name" class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="w-4 h-4 rounded-full mr-3" :style="{ backgroundColor: status.color }"></div>
              <span class="text-sm text-gray-700">{{ status.name }}</span>
            </div>
            <div class="flex items-center space-x-2 space-x-reverse">
              <span class="text-sm font-medium text-gray-900">{{ status.count }}</span>
              <span class="text-sm text-gray-500">({{ status.percentage }}%)</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø¯Ø§Ú©Ø«Ø± Ú©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø±</label>
            <input
type="number" :value="securitySettings.maxCardsPerUser" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº ØªØ±Ø§Ú©Ù†Ø´</label>
            <input
type="number" :value="securitySettings.minTransactionAmount" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø¯Ø§Ú©Ø«Ø± Ù…Ø¨Ù„Øº ØªØ±Ø§Ú©Ù†Ø´</label>
            <input
type="number" :value="securitySettings.maxTransactionAmount" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Ø²Ù…Ø§Ù† ØªØ£ÛŒÛŒØ¯ Ø®ÙˆØ¯Ú©Ø§Ø± (Ø³Ø§Ø¹Øª)</label>
            <input
type="number" :value="securitySettings.autoVerificationTime" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
        
        <div class="space-y-4">
          <div class="flex items-center">
            <input
type="checkbox" :checked="securitySettings.requireCardVerification" 
                   class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
            <label class="mr-2 text-sm text-gray-700">Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ£ÛŒÛŒØ¯ Ú©Ø§Ø±Øª</label>
          </div>
          <div class="flex items-center">
            <input
type="checkbox" :checked="securitySettings.enableCardBlocking" 
                   class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
            <label class="mr-2 text-sm text-gray-700">Ø§Ù…Ú©Ø§Ù† Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Øª</label>
          </div>
          <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { reactive, ref, watchEffect } from 'vue';
declare const useFetch: <T>(url: string, options?: unknown) => Promise<{ data: { value: T }; refresh: () => Promise<void> }>
// Ø¢Ù…Ø§Ø± Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø§Ø² API Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
const cardStats = reactive({
  totalCards: 0,
  dailyGrowth: 0,
  verifiedCards: 0,
  verificationRate: 0,
  pendingCards: 0,
  pendingPercentage: 0,
  blockedCards: 0,
  blockedPercentage: 0
})

// ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ
const securitySettings = {
  maxCardsPerUser: 5,
  minTransactionAmount: 10000,
  maxTransactionAmount: 50000000,
  autoVerificationTime: 24,
  requireCardVerification: true,
  enableCardBlocking: true
}

// Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ Ø§Ø² API Ø§Ø¯Ù…ÛŒÙ†
const bankCards = ref<any[]>([])
const page = ref(1)
const pageSize = ref(20)
const statusFilter = ref('')
const bankFilter = ref('')
const { data, refresh } = await useFetch('/api/admin/bank-accounts', {
  method: 'GET',
  query: { page, pageSize, status: statusFilter, bank: bankFilter },
  credentials: 'include',
  key: () => `admin-bank-accounts-${page.value}-${pageSize.value}-${statusFilter.value}-${bankFilter.value}`,
  defaultCache: true,
})
const paginationInfo = reactive({ start: 1, end: 0, total: 0 })
watchEffect(() => {
  const res: any = data.value
  if (!res) return
  const items = Array.isArray(res.items) ? res.items : []
  bankCards.value = items.map((x: any) => ({
    id: x.id,
    userName: x.user_name || x.user_id,
    userEmail: x.user_email || '-',
    userInitials: (x.user_name || '-').slice(0,2),
    cardNumber: x.iban ? `${x.iban.slice(0,6)}****${x.iban.slice(-4)}` : (x.card_number_last4 ? `****-${x.card_number_last4}` : '-'),
    bankName: x.bank_name || '-',
    bankIcon: 'ğŸ¦',
    cardType: 'Ú©Ø§Ø±Øª Ø¹Ø§Ø¨Ø±Ø¨Ø§Ù†Ú©',
    registrationDate: x.created_at || '-',
    status: x.status === 'active' ? 'ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡' : (x.status === 'blocked' ? 'Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡' : (x.verified_at ? 'ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡' : 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯'))
  }))
  paginationInfo.total = Number(res.total || 0)
  paginationInfo.start = (page.value-1) * pageSize.value + 1
  paginationInfo.end = Math.min(page.value * pageSize.value, paginationInfo.total)
  // Ø¢Ù…Ø§Ø± Ø³Ø§Ø¯Ù‡ Ø³Ù…Øªâ€ŒÚ©Ù„Ø§ÛŒÙ†Øª
  cardStats.totalCards = paginationInfo.total
  const verified = bankCards.value.filter((c:any)=>c.status==='ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡').length
  const blocked = bankCards.value.filter((c:any)=>c.status==='Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡').length
  const pending = Math.max(0, cardStats.totalCards - verified - blocked)
  cardStats.verifiedCards = verified
  cardStats.blockedCards = blocked
  cardStats.pendingCards = pending
  const tot = Math.max(1, cardStats.totalCards)
  cardStats.verificationRate = Math.round((verified/tot)*1000)/10
  cardStats.blockedPercentage = Math.round((blocked/tot)*1000)/10
  cardStats.pendingPercentage = Math.round((pending/tot)*1000)/10
})

async function verifyCard(id: number) {
  await $fetch(`/api/admin/bank-accounts/${id}/verify`, { method: 'POST', credentials: 'include' })
  await refresh()
}
async function blockCard(id: number) {
  await $fetch(`/api/admin/bank-accounts/${id}/block`, { method: 'POST', credentials: 'include' })
  await refresh()
}
async function unblockCard(id: number) {
  await $fetch(`/api/admin/bank-accounts/${id}/unblock`, { method: 'POST', credentials: 'include' })
  await refresh()
}
async function rejectCard(id: number) {
  await $fetch(`/api/admin/bank-accounts/${id}/reject`, { method: 'POST', credentials: 'include' })
  await refresh()
}

// Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø¯Ø± Ø¨Ø§Ù„Ø§ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯

// Ø¢Ù…Ø§Ø± Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§
const bankStats = [
  { name: 'Ù…Ù„ÛŒ', count: 4250, percentage: 28, color: '#10B981' },
  { name: 'Ù…Ù„Øª', count: 3850, percentage: 25, color: '#3B82F6' },
  { name: 'Ù¾Ø§Ø±Ø³ÛŒØ§Ù†', count: 2150, percentage: 14, color: '#F59E0B' },
  { name: 'Ø³Ù¾Ù‡', count: 1850, percentage: 12, color: '#EF4444' },
  { name: 'ØªØ¬Ø§Ø±Øª', count: 1650, percentage: 11, color: '#8B5CF6' },
  { name: 'Ø³Ø§ÛŒØ±', count: 1670, percentage: 10, color: '#6B7280' }
]

// Ø¢Ù…Ø§Ø± ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§
const statusStats = [
  { name: 'ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡', count: 14250, percentage: 92.4, color: '#10B981' },
  { name: 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯', count: 890, percentage: 5.8, color: '#F59E0B' },
  { name: 'Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡', count: 280, percentage: 1.8, color: '#EF4444' }
]

// ØªØ§Ø¨Ø¹ Ú©Ù„Ø§Ø³ Ù†ÙˆØ¹ Ú©Ø§Ø±Øª
const getCardTypeClass = (cardType: string) => {
  switch (cardType) {
    case 'Ú©Ø§Ø±Øª Ø¹Ø§Ø¨Ø±Ø¨Ø§Ù†Ú©':
      return 'bg-blue-100 text-blue-800'
    case 'Ú©Ø§Ø±Øª Ø§Ø¹ØªØ¨Ø§Ø±ÛŒ':
      return 'bg-green-100 text-green-800'
    case 'Ú©Ø§Ø±Øª Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø®Øª':
      return 'bg-purple-100 text-purple-800'
    default:
      return 'bg-gray-100 text-gray-800'
  }
}

// ØªØ§Ø¨Ø¹ Ú©Ù„Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª
const getStatusClass = (status: string) => {
  switch (status) {
    case 'ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡':
      return 'bg-green-100 text-green-800'
    case 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯':
      return 'bg-yellow-100 text-yellow-800'
    case 'Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡':
      return 'bg-red-100 text-red-800'
    case 'Ø±Ø¯ Ø´Ø¯Ù‡':
      return 'bg-gray-100 text-gray-800'
    default:
      return 'bg-gray-100 text-gray-800'
  }
}
</script>

<!--
  Ù…Ø³ØªÙ†Ø¯Ø³Ø§Ø²ÛŒ:
  Ø§ÛŒÙ† Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø´Ø§Ù…Ù„ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø§Ø³Øª:
  1. Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ (Ú©Ù„ØŒ ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡ØŒ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±ØŒ Ù…Ø³Ø¯ÙˆØ¯)
  2. ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ
  3. Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ Ø¨Ø§ Ø§Ù…Ú©Ø§Ù† ØªØ£ÛŒÛŒØ¯/Ø±Ø¯/Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù†
  4. Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ù†Ú© Ùˆ ÙˆØ¶Ø¹ÛŒØª
  5. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
  
  ØªÙ…Ø§Ù… ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø¨Ø§ Ø·Ø±Ø§Ø­ÛŒ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø§Ø±Ø§Ø¦Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.
--> 
